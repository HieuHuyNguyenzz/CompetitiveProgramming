# DP bitmask
Trong Quy hoạch động, bitmask là một kỹ thuật sử dụng các bit trong quá trình quy hoạch động để biểu diễn một tập con dựa trên các bit. Kỹ thuật này thường được sủ dụng trong các bài toán như tìm kiếm, lọc hay thao tác với một tập các phần tử. Tuy nhiên kỹ thuật bitmask để áp dụng hiệu quả cần quan tâm đến các ràng buộc giới hạn của bài toán do kỹ thuật này có thể có độ phức tạp thời gian và bộ nhớ theo cấp số nhân.

## 1. Giải thích về kỹ thuật bitmask
Mask có nghĩa mặt nạ, che dấu một thứ gì đó. Do đó bitmask có nghĩa là che dấu một thứ gì đó thông qua các bit. 

Đúng như vậy, xét tập A ={1, 2, 3, 4, 5}, chúng ta có thể biểu diễn bất kì tập con nào của A thông qua một dãy bit độ dài 5. Ví dụ tập {2, 4} có thể được biểu diễn thông qua dãy 01010, với bit thứ 2 và 4 bằng 1 tương ứng với tập con. Dãy bit trên sẽ được chuyển đổi sang hệ cơ số 10 bằng 10, do đó chúng ta có thể biểu diễn tập {2, 4} thông quan dp[10].

Các thao tác với bitmask:
- Thêm một số i vào tập con: b|(1<<i)
- Xóa số i khỏi tập con: b&!(1<<i)
- Kiểm tra phần tử i có trong tập con không: b&(1<<i), trả về 0 nếu i không có trong tập con.
- Đếm số bit 1: __builtin_popcount(s)
Để tìm tất cả các tập con của một tập thì chỉ cần loop từ 1 đến $2^n-1$ với n là kích cỡ của tập. Do đó độ phức tạp thời gian của việc áp dụng bitmask là O($2^n \times n$), nhanh hơn so với các cách làm truyền thống khác có thể lên tới O(n!)

## 2. Ví dụ
Để minh họa cho kỹ thuật bitmask, chúng ta xét bài toán sau: 

Link: [Hamiltonian Flights](https://cses.fi/problemset/task/1690)

### Đề bài 
Có n thành phố và m chuyến bay kết nối giữa chúng. Bạn muốn đi từ Syrjälä đến Lehmälä để bạn đến thăm mỗi thành phố đúng một lần. Có bao nhiêu tuyến đường khả thi?

Input:
- Dòng đầu tiên là hai số nguyên n và m: số thành phố và chuyến bay. Các thành phố được đánh số 1, 2,.., n. Thành phố 1 là Syrjälä, và thành phố n là Lehmälä.
- Sau đó, có m dòng mô tả các chuyến bay. Mỗi dòng gồm hai số nguyên a và b: có một chuyến bay từ thành phố a đến thành phố b. Tất cả các chuyến bay đều là chuyến bay một chiều.

Output:
- In ra một số nguyên: số tuyến đường theo modulo $10^9+7$.

### Ý tưởng
Đặt $dp[S][i]$ là số con đường để thăm tất cả các thành phố trong tập con S và kết thúc ở thành phố i. Khi đó ta có:

$$dp[S][i] = \sum_{x \in adj[i]} dp[S \setminus \{i\}][x] \text{ if $x \in S$}$$

với $S \setminus \{i\}$ là tập con $S$ khi bỏ đi thành phố $i$.

Vậy số con đường để thăm tất cả thành phố thuộc tập S sẽ bằng tổn các con đường đi thăm cách thành phố thuộc tập S bỏ đi i và kết thúc ở thành phố x sao cho có đường đi từ x đến i.


### Cài đặt
Chúng ta sẽ áp dụng bitmask trong quá trình biểu diễn tập S
